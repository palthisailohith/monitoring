metastore:
  # --- Enable JMX inside Hive Metastore JVM ---
  extraEnvVars: |
    - name: HADOOP_OPTS
      value: >
        -Dcom.sun.management.jmxremote
        -Dcom.sun.management.jmxremote.port=9010
        -Dcom.sun.management.jmxremote.rmi.port=9010
        -Dcom.sun.management.jmxremote.authenticate=false
        -Dcom.sun.management.jmxremote.ssl=false
        -Djava.rmi.server.hostname=127.0.0.1

  # --- Add JMX Exporter Sidecar for Prometheus ---
  extraContainers: |
    - name: jmx-exporter
      image: bitnami/jmx-exporter:0.20.0
      args:
        - --config.file=/config/config.yml
      ports:
        - containerPort: 9404
          name: metrics
      volumeMounts:
        - name: jmx-config
          mountPath: /config

  # --- Mount the JMX ConfigMap created separately ---
  extraVolumes: |
    - name: jmx-config
      configMap:
        name: hive-jmx-config
